> *–í–Ω—É—Ç—Ä–∏ —ç—Ç–æ–≥–æ –∂–µ –ø—Ä–æ–µ–∫—Ç–∞ –ª–µ–∂–∞—Ç DAG'–∏ –∏–∑ —É—Ä–æ–∫–∞ 3 ‚Äî –ø—Ä–æ –∏—Ä–∏—Å—ã –∏ –ø–æ–≥–æ–¥—É. –ó–∞–ø—É—Å–∫ —è –æ—Å—É—â–µ—Å—Ç–≤–ª—è—é –≤–Ω—É—Ç—Ä–∏ –¥–æ–∫–µ—Ä–∞, –ø–æ—ç—Ç–æ–º—É –¥–µ–ª–∞—Ç—å –æ—Ç–¥–µ–ª—å–Ω—ã–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã –ø–æ–¥ –æ—Ç–¥–µ–ª—å–Ω—ã–µ –∑–∞–¥–∞—á–∏ –æ—á–µ–Ω—å –Ω–µ —Ö–æ—á–µ—Ç—Å—è, –ø–æ–∫–∞ –æ–Ω–∏ –Ω–µ –∫–æ—Ñ–ª–∏–∫—Ç—É—é—Ç –≤–Ω—É—Ç—Ä–∏ —Å–µ–±—è. –ê –æ–Ω–∏ –Ω–µ –∫–æ–Ω—Ñ–ª–∏–∫—Ç—É—é—Ç.*


# ML Model Training with Airflow

–≠—Ç–æ—Ç –ø—Ä–æ–µ–∫—Ç —Ä–µ–∞–ª–∏–∑—É–µ—Ç –ø–∞–π–ø–ª–∞–π–Ω –º–∞—à–∏–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º Apache Airflow –¥–ª—è –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ü–∏–∏, –∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–æ–≤ —á–µ—Ä–µ–∑:
- ‚úÖ [MLflow](https://mlflow.org/)
- ‚úÖ [ClearML](https://clear.ml/)
- ‚úÖ [Weights & Biases (W&B)](https://wandb.ai/)

*MLflow* –ø–æ–¥–Ω—è—Ç –ª–æ–∫–∞–ª—å–Ω–æ –≤–Ω—É—Ç—Ä–∏ —Ç–æ–≥–æ –∂–µ docker-–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞.
---

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
.
‚îú‚îÄ‚îÄ dags/
‚îÇ   ‚îú‚îÄ‚îÄ ml_model_training_mlflow.py         # DAG –¥–ª—è MLflow
‚îÇ   ‚îú‚îÄ‚îÄ ml_model_training_clearml.py        # DAG –¥–ª—è ClearML
‚îÇ   ‚îú‚îÄ‚îÄ ml_model_training_wandb.py          # DAG –¥–ª—è Weights & Biases
‚îÇ   ‚îî‚îÄ‚îÄ ...
‚îú‚îÄ‚îÄ model1.py                                # –õ–æ–≥–∏—Å—Ç–∏—á–µ—Å–∫–∞—è —Ä–µ–≥—Ä–µ—Å—Å–∏—è (—É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π –º–æ–¥—É–ª—å)
‚îú‚îÄ‚îÄ model2.py                                # –†–µ—à–∞—é—â–µ–µ –¥–µ—Ä–µ–≤–æ (—É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π –º–æ–¥—É–ª—å)
‚îú‚îÄ‚îÄ data.py                                  # –ó–∞–≥—Ä—É–∑–∫–∞ –∏ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
‚îú‚îÄ‚îÄ clearml.conf                             # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –¥–ª—è ClearML
‚îú‚îÄ‚îÄ docker-compose.yml                       # Docker-–æ–∫—Ä—É–∂–µ–Ω–∏–µ
```

---

## üöÄ –ó–∞–ø—É—Å–∫

### 1. –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è

–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —É –≤–∞—Å —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω [Docker](https://www.docker.com/) –∏ [Docker Compose](https://docs.docker.com/compose/).

### 2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ API-–∫–ª—é—á–µ–π

#### MLflow
–õ–æ–∫–∞–ª—å–Ω—ã–π, –Ω–µ —Ç—Ä–µ–±—É–µ—Ç –∫–ª—é—á–µ–π.

#### ClearML
–£–∫–∞–∂–∏—Ç–µ —Ñ–∞–π–ª `clearml.conf` –∏ –ø—Ä–∏–º–æ–Ω—Ç–∏—Ä—É–π—Ç–µ –≤ Docker:
```yaml
volumes:
  - ./clearml.conf:/home/airflow/.clearml.conf
```

#### Weights & Biases
–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é:
```env
WANDB_API_KEY=your-api-key
```

### 3. –ó–∞–ø—É—Å–∫

```bash
docker-compose up --build
```

–û—Ç–∫—Ä–æ–π—Ç–µ Airflow UI –Ω–∞ `http://localhost:8081`

---

## ‚öôÔ∏è –§—É–Ω–∫—Ü–∏–∏

- –ú–æ–¥—É–ª—å–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –º–æ–¥–µ–ª–µ–π: –∫–æ–¥ `train()` –∏ `test()` –ø–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ —Ä–∞–∑–Ω—ã—Ö DAG
- –¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –º–µ—Ç—Ä–∏–∫, –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –∏ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç–æ–≤
- –ö–æ–Ω—Ñ–∏–≥—É—Ä–∏—Ä—É–µ–º–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ: –≤—ã–±–æ—Ä –º–µ–∂–¥—É MLflow, ClearML, W&B

---

## üìä –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

| –õ–æ–≥–∏—Ä—É–µ—Ç—Å—è       | MLflow | ClearML | W&B   |
|------------------|--------|---------|--------|
| Accuracy         | ‚úÖ      | ‚úÖ       | ‚úÖ     |
| F1 Score         | ‚úÖ      | ‚úÖ       | ‚úÖ     |
| AUC-ROC          | ‚úÖ      | ‚úÖ       | ‚úÖ     |
| Confusion Matrix | ‚úÖ      | ‚úÖ       | ‚úÖ     |
| –ú–æ–¥–µ–ª—å           | ‚úÖ      | ‚úÖ       | ‚úÖ     |

---

## üìå –ó–∞–º–µ—Ç–∫–∏

- –ú–µ—Ç—Ä–∏–∫–∏ –ª–æ–≥–∏—Ä—É—é—Ç—Å—è –≤ DAG –ø–æ—Å–ª–µ –≤—ã–∑–æ–≤–∞ `test()`, —á—Ç–æ–±—ã –æ–±–µ—Å–ø–µ—á–∏—Ç—å —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–æ—Å—Ç—å –º–æ–¥–µ–ª–µ–π
- –ê—Ä—Ç–µ—Ñ–∞–∫—Ç—ã —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –∫–∞–∫ `.json` –∏ `.pkl` 
- –í—Å–µ DAG –∏—Å–ø–æ–ª—å–∑—É—é—Ç `PythonOperator`


## üì∑ –ü—Ä–∏–º–µ—Ä—ã –ª–æ–≥–æ–≤ –∏ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç–æ–≤

### MLFlow

![MLFlow Example](/docs/mlflow_example_1.png)
![MLFlow Example](/docs/mlflow_example_2.png)
![MLFlow Example](/docs/mlflow_example_3.png)

### ClearML

![ClearML Example](/docs/clearml_example_1.png)
![ClearML Example](/docs/clearml_example_2.png)
![ClearML Example](/docs/clearml_example_3.png)
![ClearML Example](/docs/clearml_example_4.png)
![ClearML Example](/docs/clearml_example_5.png)


### Weights & Biases (W&B)

![WandB Run](/docs/wandb_example_1.png)
![WandB Run](/docs/wandb_example_2.png)
![WandB Run](/docs/wandb_example_3.png)
![WandB Run](/docs/wandb_example_4.png)



